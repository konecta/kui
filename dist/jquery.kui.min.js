/*! kui - v0.0.4 - 2015-02-03
* https://github.com/konecta/kui
* Copyright (c) 2015 Nelson Paez; Licensed MIT */
/*! 
 *
 *   +++++++++++++++++++++ Core +++++++++++++++++++++ 
 *
 */
!function(a){a.fn.kui=function(){return this.each(function(b){a(this).html("kui"+b)})},a.kui=function(b){return b=a.extend({},a.kui.options,b),"kui"+b.punctuation},a.kui.options={punctuation:"."},a.expr[":"].kui=function(b){return-1!==a(b).text().indexOf("kui")},a.kui.formulario={nuevo_elemento:function(b,c,d,e){var f,g=function(){return"function"==typeof e.formato?e.formato.call(this,d[e.nombre],d):d[e.nombre]},h=function(b){return a("<"+b+">").addClass("form-control").attr("data-rol","input").attr("name",e.nombre).attr("placeholder",void 0===e.placeholder?e.titulo:e.placeholder).attr("title",void 0===e.mensaje?"El formato ingresado no es correcto para "+e.titulo:e.mensaje).val(g()).prop("required",e.requerido)},i=function(b){void 0!==e.icono&&(b=e.icono);var d=h("input");if(e.simple)d.appendTo(c);else{var f=a("<div>").addClass("input-group").appendTo(c);a("<span>").addClass("input-group-addon").html('<i class="fa fa-'+b+'"></i>').appendTo(f),d.appendTo(f)}return d},j=function(){var d=h(b?"input":"select");if(d.appendTo(c),!b){var f=[];"string"==typeof e.opciones.origen?a.ajax({type:e.opciones.ajax,url:e.opciones.origen,data:void 0===e.opciones.data?{_search:!1,filters:null,page:1,rows:10,sidx:e.opciones.id,sord:"asc",todos:!0}:e.opciones.data,success:function(a){a.error||(f=a.respuesta.datos)},async:!1}):f=e.opciones.origen;var i=!1;a.each(f,function(b,c){var f=a("<option>").attr("value",c[e.opciones.id]).html("function"==typeof e.opciones.formato?e.opciones.formato.call(this,c):c[e.opciones.formato]).appendTo(d);g()===c[e.opciones.id]&&(f.attr("selected",!0),i=!0)}),i||a("<option>").attr("value","").html("").attr("selected",!0).prependTo(d),d.combobox()}return d},k={fecha:{icono:"calendar",formato:"dd/MM/yyyy",constructor:{pickTime:!1}},hora:{icono:"clock-o",formato:"hh:mm:ss",constructor:{pickDate:!1}},"fecha-hora":{icono:"clock-o",formato:"dd/MM/yyyy hh:mm:ss"}},l=function(c){var d=i(k[c].icono),e=d.parent();if(e.addClass("date"),d.attr("data-format",k[c].formato).attr("type","text").prependTo(e),"hora"!==c&&d.attr("data-rule-date",!0),!b){e.find(".input-group-addon").addClass("add-on");var f={language:"es",autoclose:!0};a.extend(f,k[c].constructor),e.datetimepicker(f)}return d};switch(e.tipo){case"booleano":f=h("input"),f.appendTo(c),f.prop("type","checkbox"),("true"===f.val()||"S"===f.val().toUpperCase())&&f.attr("checked","checked"),f.removeClass("form-control").css("margin-top","10px");break;case"numero":f=i("circle-thin"),f.attr("type","number");break;case"decimal":f=i("circle-thin"),f.attr("type","number"),f.attr("step","any");break;case"archivo":f=i("file"),f.attr("type","file");break;case"combo":f=j();break;case"fecha":f=l("fecha");break;case"hora":f=l("hora");break;case"fecha-hora":f=l("fecha-hora");break;default:return f=i("align-right"),void f.attr("type","text")}if(void 0!==e.atributos){a.each(e.atributos,function(a,b){f.attr(a,b)});var m=["disabled","readonly"];a.each(m,function(a,b){"false"===e.atributos[b]&&f.removeAttr(b),f.attr("data-"+b,e.atributos[b])})}},validar:{reglas:function(){a.validator.methods.date=function(a,b){var c=!1,d=/^\d{1,2}\/\d{1,2}\/\d{4}$/,e=/^\d{1,2}-\d{1,2}-\d{4}$/,f=function(b){var d=a.split(b),e=parseInt(d[0],10),f=parseInt(d[1],10),g=parseInt(d[2],10),h=new Date(g,f-1,e);c=h.getFullYear()===g&&h.getMonth()===f-1&&h.getDate()===e?!0:!1};return d.test(a)?f("/"):e.test(a)?f("-"):c=!1,this.optional(b)||c}},error:function(b,c,d){a.each(b.validElements(),function(b,c){var d=a(c);d.data("title","").removeClass("error").tooltip("destroy"),d.parent().removeClass("has-error")}),a.each(d,function(b,c){var d=a(c.element);d.tooltip("destroy").data("title",c.message).addClass("error").tooltip(),d.parent().addClass("has-error")})},fecha:function(b){a(b).find("input[data-rule-date=true]").each(function(b,c){var d,e=a(c).val(),f={dd:0,MM:1,yyyy:2};e.indexOf("/")>0?d=e.split("/"):(d=e.split("-"),f.yyyy=0,f.dd=2),a(c).val(3===d.length?d[f.yyyy]+"-"+d[f.MM]+"-"+d[f.dd]:"")})}}}}(jQuery);